(()=>{const t={client:"Netzproduzenten",project:"Project Name",site_url:"https://electropapa.com/de",test_name:"Test018 A/B/C - Followup016 - PDS & Side Cart - Volume discount",page_initials:"AB-TEST-018",test_variation:1,test_version:7e-4},{page_initials:e,test_variation:n,test_version:o}=t,a=[e,`${e}--v${n}`,`${e}--version-${o}`];function c(t,e,n=2e4,o=150){n<=0?console.warn(`Timeout reached while waiting for condition: ${t.toString()}`):t&&t()?e():setTimeout((()=>c(t,e,n-o,o)),o)}function i(t,e){return e?t.querySelector(e):document.querySelector(t)}function r(t,e){return e?[...t.querySelectorAll(e)]:[...document.querySelectorAll(t)]}function l(t,e,n){c((()=>i(t)),(()=>{const o=i(t),a=new MutationObserver(e);return a.observe(o,n),a}))}function s(t){return t?parseFloat(t.innerText?.replace(".","")?.replace(",",".")?.replace("€","")):0}function u(t,e=!1){const n=new Intl.NumberFormat("de-DE",{style:"currency",currency:"EUR"}).format(t);return e?n.replaceAll(" ",""):n}async function d(t){const e=i(t,"a.line-item-label")?.getAttribute("href")||"",n=s(i(t,".line-item-total-price-value")),o=+i(t,"input.quantity-selector-group-input")?.value||0,a=await async function(t){return fetch(t).then((t=>t.text())).then((t=>{const e=(new DOMParser).parseFromString(t,"text/html").querySelector(".product-detail-price");if(e)return s(e);throw new Error("Price element not found")}))}(e)*o;return{totalPrice:a,offerPrice:n,discount:a-n,quantity:o}}function p({targetNode:t,totalPrice:e,quantity:n,discount:o,offerPrice:a}){const c=`\n            <div class="ab-celebration-message-container ${n<=1?"ab-celebration-message-container--viewing-for-single":""}">\n                ${function({targetNode:t,totalPrice:e,quantity:n,discount:o,offerPrice:a}){const c=`Glückwunsch! Du sparst ${u(o,!0)} durch unseren Mengenrabatt.`;return n<=1?"":c}({targetNode:t,totalPrice:e,quantity:n,discount:o,offerPrice:a})}\n            </div>\n        `;setTimeout((()=>{var e,o;i(t,".ab-celebration-message-container")||(t.insertAdjacentHTML("beforeend",c),n>1&&(e="Shows Celebration Message | JS",o=1004106272,console.log("Triggered convert goal: ",e,o),window._conv_q=window._conv_q||[],_conv_q.push(["triggerConversion",o])))}),0)}function f(){const t=".offcanvas-cart-items .line-item";c((()=>r(t).length>0),(()=>{r(t).forEach((async t=>{const{totalPrice:e,quantity:n,discount:o,offerPrice:a}=await d(t);!function({targetNode:t,totalPrice:e,quantity:n,discount:o,offerPrice:a}){const c=i(t,".line-item-total-price:not(.ab-added-reduced-total)");n>1&&c&&(c.classList.add("ab-added-reduced-total"),c.insertAdjacentHTML("afterbegin",`<div class="ab-total-price">${u(e)}</div>`))}({targetNode:t,totalPrice:e,quantity:n,discount:o,offerPrice:a}),p({targetNode:t,totalPrice:e,quantity:n,discount:o,offerPrice:a})}))}))}function g(t,e){t.forEach((t=>{if(t.addedNodes.length>0){const e=Array.from(t.addedNodes).find((t=>1===t.nodeType&&t.classList?.contains("offcanvas-body")));e&&e.querySelector(".offcanvas-cart-items .line-item")&&f()}}))}function y(){return l(".offcanvas",g,{childList:!0,subtree:!0})}function m(t,e){t.forEach((t=>{if(t.addedNodes.length>0){Array.from(t.addedNodes).find((t=>1===t.nodeType&&t.classList?.contains("offcanvas")))&&y()}}))}function b(t){const e=i(".ab-quantity-dropdown-layout"),n="true"===e.getAttribute("expanded")?.toLowerCase();"toggle"===t?e.setAttribute("expanded",!n):"show"===t?e.setAttribute("expanded",!0):"hide"===t&&e.setAttribute("expanded",!1)}function v(){c((()=>i("body.is-ctl-product.is-act-index #productDetailPageBuyProductForm")),(()=>{r("#productDetailPageBuyProductForm .col-2.col-md-1.col-lg-2.col-xl-1").forEach((t=>{t.classList.remove("col-lg-2"),t.classList.add("col-lg-1")})),r("#productDetailPageBuyProductForm .col-4.col-sm-3.d-flex.justify-content-end").forEach((t=>{t.classList.remove("col-sm-3"),t.classList.add("col-5","col-sm-4")})),r("#productDetailPageBuyProductForm .col-6.col-sm-7.col-md-8.col-lg-7.col-xl-8").forEach((t=>{t.classList.remove("col-6","col-md-8","col-xl-8"),t.classList.add("col-5")})),r("#productDetailPageBuyProductForm .col-sm-9, #productDetailPageBuyProductForm .col-md-9").forEach((t=>{t.classList.remove("col-sm-9","col-md-9"),t.classList.add("col-sm-8")})),function(){const t=i(".product-detail-quantity-group.quantity-selector-group"),e=[{value:1,label:"1 Stück",discount_percentage:0},{value:2,label:"2 Stück",discount_percentage:5},{value:3,label:"3 Stück",discount_percentage:5},{value:4,label:"4 Stück",discount_percentage:6},{value:5,label:"5 Stück",discount_percentage:6},{value:6,label:"6 Stück",discount_percentage:8},{value:7,label:"7 Stück",discount_percentage:8},{value:8,label:"8 Stück",discount_percentage:8},{value:9,label:"9 Stück",discount_percentage:8},{value:10,label:"10 Stück",discount_percentage:10},{value:11,label:"11+ Stück",discount_percentage:10}],n=`\n            <div class="ab-quantity-dropdown-layout" expanded="false">\n                <div class="ab-quantity-dropdown-select">\n                    ${i(t,".product-detail-quantity-group.quantity-selector-group input.product-detail-quantity-input")?.value||e[0].label} Stück\n                </div>\n                <ul class="ab-quantity-dropdown-options">\n                    ${e.map((({value:t,label:e,discount_percentage:n})=>`\n                            <li class="ab-quantity-dropdown-option" value="${t}">\n                                <span class="ab-quantity-dropdown-option__value">${e}</span>\n                                ${t<=10?`<span class="ab-quantity-dropdown-option__green-badge">Spare ${n}%</span>`:'<span class="ab-quantity-dropdown-option__ten-plus-badge"><i>Bitte Mail an uns</i></span>'}\n                            </li>\n                        `)).join("")}\n                </ul>\n            </div>\n        `;t.insertAdjacentHTML("afterend",n)}()}))}function h(){window.location.href.includes("/checkout/cart")&&c((()=>r(".checkout-product-table .line-item").length>0&&i(".checkout-aside-summary-list .checkout-aside-summary-value:first-of-type")),(async()=>{const t=r(".checkout-product-table .line-item"),e=await Promise.all(t.map((t=>d(t)))),n=e.reduce(((t,{totalPrice:e})=>t+e),0),o=n-e.reduce(((t,{offerPrice:e})=>t+e),0);0!==o&&(function(t){i(".checkout-aside-summary-list").insertAdjacentHTML("afterbegin",`<div class="col-12"><div class="ab-total-price">${u(t)}</div></div>`)}(n),function(t){const e=`\n            <div class="col-12">\n                <div class="ab-celebration-message-container ">Glückwunsch! Du sparst ${u(t,!0)} durch unseren Mengenrabatt.</div>\n            </div>\n        `;i(".checkout-aside-summary-list .checkout-aside-summary-value:first-of-type").insertAdjacentHTML("afterend",e)}(o))}))}c((function(){return!!document.querySelector(`body:not(.${a[0]}):not(.${a[1]})`)}),(function(){document.body.classList.add(...a),console.table(t),l("body",m,{childList:!0}),y(),v(),document.body.addEventListener("click",(t=>{if(t.target.closest(".ab-quantity-dropdown-select")&&b("toggle"),i(".ab-quantity-dropdown-select")&&!t.target.closest(".ab-quantity-dropdown-layout")&&b("hide"),t.target.closest(".ab-quantity-dropdown-option")){const e=t.target.closest(".ab-quantity-dropdown-option").getAttribute("value");i(".product-detail-quantity-group.quantity-selector-group input.product-detail-quantity-input").value=e,i(".ab-quantity-dropdown-select").innerText=e+" Stück",b("hide")}})),h()}))})();
