(()=>{const e={client:"Netzproduzenten",project:"Project Name",site_url:"https://electropapa.com/de",test_name:"Test019 [Electropapa] A/B/C - Followup016 - PDS & Side Cart - Textlink Popup and Volume discount nudge cart",page_initials:"AB-TEST-019",test_variation:2,test_version:3e-4},{page_initials:t,test_variation:n,test_version:r}=e,i=[t,`${t}--v${n}`,`${t}--version-${r}`];function s(e,t,n=2e4,r=150){n<=0?console.warn(`Timeout reached while waiting for condition: ${e.toString()}`):e&&e()?t():setTimeout((()=>s(e,t,n-r,r)),r)}function a(e,t){return t?e.querySelector(t):document.querySelector(e)}function o(e,t){return t?[...e.querySelectorAll(t)]:[...document.querySelectorAll(e)]}function c(e,t,n){s((()=>a(e)),(()=>{const r=a(e),i=new MutationObserver(t);return i.observe(r,n),i}))}function l(e){return e?parseFloat(e.innerText?.replace(".","")?.replace(",",".")?.replace("€","")):0}function d(e,t=!1){const n=new Intl.NumberFormat("de-DE",{style:"currency",currency:"EUR"}).format(e);return t?n.replaceAll(" ",""):n}async function b(e){const t=a(e,"a.line-item-label")?.getAttribute("href")||"",n=l(a(e,".line-item-total-price-value")),r=+a(e,"input.quantity-selector-group-input")?.value||0,i=await async function(e){return fetch(e).then((e=>e.text())).then((e=>{const t=(new DOMParser).parseFromString(e,"text/html").querySelector(".product-detail-price");if(t)return l(t);throw new Error("Price element not found")}))}(t)*r;return{totalPrice:i,offerPrice:n,discount:i-n,quantity:r}}function u({targetNode:e,totalPrice:t,quantity:n,discount:r,offerPrice:i}){var s,o;!a(e,".ab-single-item-progress-btn-container")&&n<2&&(a(e,".line-item-quantity").classList.add("ab-hidden"),a(e,".line-item-remove").insertAdjacentElement("beforeend",a(e,".line-item-total-price.line-item-price")),e.insertAdjacentHTML("beforeend",'\n            <div class="ab-single-item-progress-btn-container">\n                <div class="ab-single-item-progress-btn-container__heading">Jetzt zum Sparpreis immer Ersatz parat haben</div>\n                <div class="ab-single-item-progress-btn-container__progress-bar" step="1">\n                    <div class="ab-single-item-progress-btn-container__progress-bar__pointer ab-single-item-progress-btn-container__progress-bar__pointer--2"></div>\n                    <div class="ab-single-item-progress-btn-container__progress-bar__pointer ab-single-item-progress-btn-container__progress-bar__pointer--3"></div>\n                </div>\n                <div class="ab-single-item-progress-btn-container__btn-container">\n                    <div class="ab-single-item-progress-btn-container__btn ab-single-item-progress-btn-container__btn--selected" quantity="1">\n                        <span class="ab-single-item-progress-btn-container__btn__label">1 Stück</span>\n                        <span class="ab-single-item-progress-btn-container__btn__badge"></span>\n                    </div>\n                    <div class="ab-single-item-progress-btn-container__btn" quantity="2">\n                        <span class="ab-single-item-progress-btn-container__btn__label">2 Stück</span>\n                        <span class="ab-single-item-progress-btn-container__btn__badge">Spare 5%</span>\n                    </div>\n                    <div class="ab-single-item-progress-btn-container__btn" quantity="4">\n                        <span class="ab-single-item-progress-btn-container__btn__label">4 Stück</span>\n                        <span class="ab-single-item-progress-btn-container__btn__badge">Spare 6%</span>\n                    </div>\n                </div>\n            </div>\n        ')),!a(e,".ab-celebration-message-container")&&n>1&&(e.insertAdjacentHTML("beforeend",`<div class="ab-celebration-message-container">${function({targetNode:e,totalPrice:t,quantity:n,discount:r,offerPrice:i}){const s=`Glückwunsch! Du sparst ${d(r,!0)} durch unseren Mengenrabatt.`;return n<=1?"<b>Clever sein und sparen:</b>&nbspAb 2 Stück mindestens 5% Rabatt":s}({targetNode:e,totalPrice:t,quantity:n,discount:r,offerPrice:i})}</div>`),n>1&&(s="Shows Celebration Message | JS",o=1004106272,console.log("Triggered convert goal: ",s,o),window._conv_q=window._conv_q||[],_conv_q.push(["triggerConversion",o])))}function g(){o(".offcanvas-cart-items .line-item").forEach((async e=>{const{totalPrice:t,quantity:n,discount:r,offerPrice:i}=await b(e);!function({targetNode:e,totalPrice:t,quantity:n,discount:r,offerPrice:i}){const s=a(e,".line-item-total-price:not(.ab-added-reduced-total)");n>1&&s&&(s.classList.add("ab-added-reduced-total"),s.insertAdjacentHTML("afterbegin",`<div class="ab-total-price ">${d(t)}</div>`))}({targetNode:e,totalPrice:t,quantity:n,discount:r,offerPrice:i}),u({targetNode:e,totalPrice:t,quantity:n,discount:r,offerPrice:i})}))}function p(e,t){e.forEach((e=>{if(e.addedNodes.length>0){const t=Array.from(e.addedNodes).find((e=>1===e.nodeType&&e.classList?.contains("offcanvas-body")));t&&t.querySelector(".offcanvas-cart-items .line-item")&&g()}}))}function _(){return c(".offcanvas",p,{childList:!0,subtree:!0})}function m(e,t){e.forEach((e=>{if(e.addedNodes.length>0){Array.from(e.addedNodes).find((e=>1===e.nodeType&&e.classList?.contains("offcanvas")))&&_()}}))}s((function(){return!!document.querySelector(`body:not(.${i[0]}):not(.${i[1]})`)}),(function(){document.body.classList.add(...i),console.table(e),c("body",m,{childList:!0}),_(),document.body.addEventListener("click",(e=>{if(e.target.closest(".ab-single-item-progress-btn-container__btn:not(.ab-single-item-progress-btn-container__btn--selected)")){const t=e.target.closest(".ab-single-item-progress-btn-container__btn:not(.ab-single-item-progress-btn-container__btn--selected)"),n=t.getAttribute("quantity"),r=e.target.closest(".ab-single-item-progress-btn-container");o(r,".ab-single-item-progress-btn-container__btn").forEach((e=>{const n="ab-single-item-progress-btn-container__btn--selected";e===t?e.classList.add(n):e.classList.remove(n)}));const i=a(r,".ab-single-item-progress-btn-container__progress-bar");"1"===n?i.setAttribute("step",1):"2"===n?i.setAttribute("step",2):"4"===n&&i.setAttribute("step",3);const s=a(e.target.closest(".line-item"),".js-offcanvas-cart-change-quantity-number");s.value=n;const c=new Event("change",{bubbles:!0});s.dispatchEvent(c)}if(e.target.closest(".ab-quantity-dropdown-option")){const t=e.target.closest(".ab-quantity-dropdown-option").getAttribute("value");a(".product-detail-quantity-group.quantity-selector-group input.product-detail-quantity-input").value=t}}))}))})();
