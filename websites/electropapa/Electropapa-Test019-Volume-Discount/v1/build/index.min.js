(()=>{const e={client:"Netzproduzenten",project:"Project Name",site_url:"https://electropapa.com/de",test_name:"Test019 [Electropapa] A/B/C - Followup016 - PDS & Side Cart - Textlink Popup and Volume discount nudge cart",page_initials:"AB-TEST-019",test_variation:1,test_version:2e-4},{page_initials:t,test_variation:n,test_version:a}=e,i=[t,`${t}--v${n}`,`${t}--version-${a}`];function o(e,t,n=2e4,a=150){n<=0?console.warn(`Timeout reached while waiting for condition: ${e.toString()}`):e&&e()?t():setTimeout((()=>o(e,t,n-a,a)),a)}function s(e,t){return t?e.querySelector(t):document.querySelector(e)}function c(e,t){return[...document.querySelectorAll(e)]}function l(e,t,n){o((()=>s(e)),(()=>{const a=s(e),i=new MutationObserver(t);return i.observe(a,n),i}))}function r(e,t=!1){const n=new Intl.NumberFormat("de-DE",{style:"currency",currency:"EUR"}).format(e);return t?n.replaceAll(" ",""):n}function d(e){const t=function(e){return e?parseFloat(e.innerText?.replace(".","")?.replace(",",".")?.replace("€","")):0}(s(e,".line-item-total-price-value")),n=+s(e,"input.quantity-selector-group-input")?.value||0,a=function(e,t){const n=[0,0,5,5,6,6,8,8,8,8,10];return e/(1-(t<=10?n[t]:n[10])/100)}(t,n);return{totalPrice:a,offerPrice:t,discount:a-t,quantity:n}}function u(e){const{quantity:t}=d(e);var n,a;s(e,".ab-celebration-message-container")||(e.insertAdjacentHTML("beforeend",`<div class="ab-celebration-message-container ${t<=1?"ab-celebration-message-container--viewing-for-single":""}">${function(e){const{discount:t,quantity:n}=d(e),a=`Glückwunsch! Du sparst ${r(t,!0)} durch unseren Mengenrabatt.`;return n<=1?"":a}(e)}</div>`),t>1&&(n="Shows Celebration Message | JS",a=1004106272,console.log("Triggered convert goal: ",n,a),window._conv_q=window._conv_q||[],_conv_q.push(["triggerConversion",a])))}function p(){c(".offcanvas-cart-items .line-item").forEach((e=>{!function(e){const{totalPrice:t,quantity:n}=d(e),a=s(e,".line-item-total-price:not(.ab-added-reduced-total)");n>1&&a&&(a.classList.add("ab-added-reduced-total"),a.insertAdjacentHTML("afterbegin",`<div class="ab-total-price ">${r(t)}</div>`))}(e),u(e)}))}function v(e,t){e.forEach((e=>{if(e.addedNodes.length>0){const t=Array.from(e.addedNodes).find((e=>1===e.nodeType&&e.classList?.contains("offcanvas-body")));t&&t.querySelector(".offcanvas-cart-items .line-item")&&p()}}))}function b(){return l(".offcanvas",v,{childList:!0,subtree:!0})}function f(e,t){e.forEach((e=>{if(e.addedNodes.length>0){Array.from(e.addedNodes).find((e=>1===e.nodeType&&e.classList?.contains("offcanvas")))&&b()}}))}function g(e){const t=document.body,n=i[0]+"--show-volume-discount-modal";"show"===e?t.classList.add(n):"hide"===e&&t.classList.remove(n)}o((function(){return!!document.querySelector(`body:not(.${i[0]}):not(.${i[1]})`)}),(function(){document.body.classList.add(...i),console.table(e),l("body",f,{childList:!0}),b(),function(){const e=[{value:1,label:1,discount_percentage:0},{value:2,label:2,discount_percentage:5},{value:3,label:3,discount_percentage:5},{value:4,label:4,discount_percentage:6},{value:5,label:5,discount_percentage:6},{value:6,label:6,discount_percentage:8},{value:7,label:7,discount_percentage:8},{value:8,label:8,discount_percentage:8},{value:9,label:9,discount_percentage:8},{value:10,label:10,discount_percentage:10},{value:11,label:"11+",discount_percentage:10}];o((()=>2===c(".product-detail-tax-link, .product-delivery-available").length),(()=>{s(".product-detail-tax-link").insertAdjacentHTML("afterend",'<span class="ab-volume-discount-modal-cta">Sparpreis bei höherer Stückzahl verfügbar</span>'),s(".product-delivery-available").insertAdjacentHTML("afterend",'\n                        <div class="ab-free-delivery-txt-cta-container">\n                            <div class="product-delivery-available">\n                                <div>\n                                    <span class="delivery-status-indicator bg-success"></span>\n                                </div>\n                                <div class="high-availability">\n                                    <span class="text-success fw-bold">Auf Lager</span>\n                                </div>\n                            </div>\n                            <div class="product-delivery-available ab-free-delivery-txt-cta">\n                                <div>\n                                    <span class="delivery-status-indicator bg-success"></span>\n                                </div>\n                                <div class="high-availability">\n                                    <span class="text-success fw-bold">Kostenfreie Lieferung in DE</span>\n                                </div>\n                            </div>\n                        </div>\n                    '),s("body").insertAdjacentHTML("afterbegin",`\n                        \x3c!-- MODAL  --\x3e\n                        <div class="ab-quantity-modal-layout">\n                            <div class="ab-quantity-modal-backdrop"></div>\n                            <div class="ab-quantity-modal">\n                                <div class="ab-quantity-modal__container">\n                                    <div class="ab-quantity-modal__close-cta btn-close close"></div>\n                                    <div class="ab-quantity-modal__heading">Jetzt zum Sparpreis immer Ersatz parat haben</div>\n                                    <div class="ab-quantity-modal__sub-heading">Clever sein und sparen!</div>\n                                    <div class="ab-quantity-dropdown-layout">\n                                        <ul class="ab-quantity-dropdown-options">\n                                            ${e.map((({value:e,label:t,discount_percentage:n})=>`\n                                                    <li class="ab-quantity-dropdown-option" value="${e}">\n                                                        <span class="ab-quantity-dropdown-option__value">${t} Stk.</span>\n                                                        ${e<=10?`<span class="ab-quantity-dropdown-option__green-badge">Spare ${n}%</span>`:'<span class="ab-quantity-dropdown-option__ten-plus-badge"><i>Bitte Mail an uns</i></span>'}\n                                                    </li>\n                                                `)).join("")}\n                                        </ul>\n                                    </div>\n                                </div>\n                            </div>\n                        </div>\n                    `)}))}(),document.body.addEventListener("click",(e=>{if(e.target.closest(".ab-free-delivery-txt-cta")&&s(".product-detail-tax-link").click(),e.target.closest(".ab-volume-discount-modal-cta")&&g("show"),(e.target.closest(".ab-quantity-modal__close-cta")||e.target.closest(".ab-quantity-modal-backdrop")&&!e.target.closest(".ab-quantity-modal"))&&g("hide"),e.target.closest(".ab-quantity-dropdown-option")){const t=e.target.closest(".ab-quantity-dropdown-option").getAttribute("value");s(".product-detail-quantity-group.quantity-selector-group input.product-detail-quantity-input").value=t,g("hide")}}))}))})();
