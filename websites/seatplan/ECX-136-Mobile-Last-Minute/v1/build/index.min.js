(()=>{const e="AB-ECX-136",t=1,n=1e-4;function o(e,t,n=1e4,i=100){try{if(n<=0)throw new Error(`Timeout reached while waiting for condition: ${e.toString()}`);e&&e()?t():setTimeout((()=>{o(e,t,n-i,i)}),i)}catch(e){return void console.warn(e)}}function i(){const e=document.querySelector("#last-minute-day-select").value;document.querySelectorAll(`.sp-table__cell.last-minute__day-col[data-date='${e}']`).forEach((e=>{const t=e.parentNode;"-"===e.querySelector("div").innerText?t.classList.add("ab-hidden"):t.classList.remove("ab-hidden")}))}function a(){document.querySelector("#last-minute-day-select").addEventListener("change",(e=>{e.target.value,i(),console.log("Trigger Goal: EXP-681: Last Minute - Change Date | JS"),window._conv_q=window._conv_q||[],_conv_q.push(["triggerConversion","1004103971"])}))}function c(e){const t=document.querySelector("#last-minute-day-select");let n=document.querySelector(`#last-minute-day-select option[value='${t.value}']`);const o=t.options.length;let i=t.selectedIndex;if("prev"===e&&0===i||"next"===e&&i===o-1)return;n.removeAttribute("selected"),"prev"===e?(n=n.previousElementSibling,i--):"next"===e&&(n=n.nextElementSibling,i++),t.value=n.value,n.setAttribute("selected","selected");const a=new Event("change",{bubbles:!0});t.dispatchEvent(a);const c=document.querySelector(".ab-last-minute__date-heading");c.innerText=n.innerText,c.setAttribute("value",n.value),document.querySelectorAll(".ab-last-minute__button").forEach((e=>{e.classList.remove("ab-last-minute__button--disabled"),(0===i&&e.querySelector(".sp-icon-chevron-left")||i===o-1&&e.querySelector(".sp-icon-chevron-right"))&&e.classList.add("ab-last-minute__button--disabled")}))}function s(){const{hour:e,timeString:t}=function(){const e=new Intl.DateTimeFormat("en-GB",{timeZone:"Europe/London",hour12:!1,hour:"2-digit",minute:"2-digit",second:"2-digit"}).formatToParts(new Date),t=Object.fromEntries(e.map((({type:e,value:t})=>[e,t])));return{hour:parseInt(t.hour,10),timeString:`${t.hour}:${t.minute}:${t.second}`}}();return{isBetween:e>=19&&e<=23,londonTimeString:t}}o((function(){return!!(window.location.href.includes("whats-on/last-minute/")&&document.querySelector(`body:not(.${e}):not(${e}--v${t})`)&&document.querySelector(".last-minute__date-select #last-minute-day-select")&&document.querySelector(".sp-table__row.last-minute__table-row"))}),(function(){document.body.classList.add(e,`${e}--v${t}`,`${e}--version-${n}`),function(){const e=document.querySelector("#last-minute-day-select");document.querySelector(".last-minute__date-select").insertAdjacentHTML("afterend",`\n                <div class="ab-last-minute">\n                    <button class="ab-last-minute__button ab-last-minute__button--disabled">\n                        <span class="ab-last-minute__button-icon sp-icon sp-icon-chevron-left"></span>\n                    </button>\n                    <div class="ab-last-minute__date-heading" value="${e.value}">${e.querySelector("option[selected]").innerText}</div>\n                    <button class="ab-last-minute__button">\n                        <span class="ab-last-minute__button-icon sp-icon sp-icon-chevron-right"></span>\n                    </button>\n                </div>\n            `)}(),document.querySelectorAll(".ab-last-minute__button").forEach((e=>{const t=e.querySelector(".sp-icon-chevron-left")?"prev":"next";e.addEventListener("click",(e=>{c(t)}))})),i(),a(),o((()=>"complete"===document.readyState),(()=>{s().isBetween&&c("next")}))}))})();
