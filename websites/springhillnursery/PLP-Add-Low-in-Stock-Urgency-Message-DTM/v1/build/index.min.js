(async()=>{const t={client:"EchoLogyx",project:"springhillnursery",site_url:"https://springhillnursery.com",test_name:"PLP - Add Low in Stock Urgency Message [DTM]",page_initials:"AB-PLP-URGENCY",test_variation:1,test_version:3e-4},{page_initials:e,test_variation:n,test_version:o}=t;function r(t,e){return e?t.querySelector(e):document.querySelector(t)}const i={1:"Hurry! Selling Fast!",2:"Low in Stock"},a="ab-urgency-shuffled-data";function c(){return new URLSearchParams(window.location.search).get("page")||"1"}function s(){try{const t=sessionStorage.getItem(a);return t?JSON.parse(t):{}}catch(t){return{}}}function l(){const t=window.location.pathname,e=c(),n=s();return n[t]?.[e]||null}function u(t){const e=window.location.pathname,n=c(),o=s();o[e]||(o[e]={}),o[e][n]=t,function(t){try{sessionStorage.setItem(a,JSON.stringify(t))}catch(t){return}}(o)}function d(t){for(let e=t.length-1;e>0;e--){const n=Math.floor(Math.random()*(e+1));[t[e],t[n]]=[t[n],t[e]]}return t}function g(){console.log("updateLayout...");const t=(e=".product-item[data-id]:not(.ab-urgency-msg-injected):not(:has( .soldoutstrip))",[...document.querySelectorAll(e)]);var e;if(0===t.length)return;const o=l();let a;if(o)a=o.map((e=>t.find((t=>t.getAttribute("data-id")===e)))).filter((t=>void 0!==t));else{a=function(t){if(1===t.length)return t;const e=Math.max(1,Math.min(t.length,Math.round(.3*t.length))),n=Math.min(Math.floor(3*Math.random()),t.length-1),o=t[n],r=d([...t.filter(((t,e)=>e!==n))]);return d([o,...r.slice(0,e-1)])}(t);u(a.map((t=>t.getAttribute("data-id"))))}console.log("Log 1","Total Cards",t.length),console.log("Log 2","Total Selected Cards",a.length),console.log("Log 3","Selected/Stored Cards",l()),a.forEach((t=>{t.classList.add("ab-urgency-msg-injected"),r(t,".product-item__text_group_primary").insertAdjacentHTML("beforeend",`<div class="ab-urgency-msg">${i[n]}</div>`)}))}function f(){const t=r("#root"),e=function(t,e){let n;return function(...o){clearTimeout(n),n=setTimeout((()=>{clearTimeout(n),t(...o)}),e)}}(g,250);return new MutationObserver(e).observe(t,{childList:!0,subtree:!1,attributes:!1})}try{await async function(t,e=2e4,n=150){const o=Date.now();return new Promise(((r,i)=>{if("function"==typeof t&&t())return r(!0);const a=setInterval((()=>Date.now()-o>=e?(clearInterval(a),i(new Error(`Timeout of ${e}ms reached while waiting for condition: ${t.toString()}`))):"function"==typeof t&&t()?(clearInterval(a),r(!0)):void 0),n)}))}((function(){return!!(r(`body:not(.${e}):not(.${e}--v${n})`)&&r("#root")&&r(".collection__products-container")&&"complete"===document.readyState)})),r("body").classList.add(e,`${e}--v${n}`,`${e}--version:${o}`),console.table(t),g(),f()}catch(t){return console.warn(t),!1}})();
